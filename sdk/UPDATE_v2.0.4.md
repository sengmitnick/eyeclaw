# EyeClaw SDK v2.0.4 æ›´æ–°è¯´æ˜

## å‘å¸ƒä¿¡æ¯

- **ç‰ˆæœ¬å·**: 2.0.4
- **å‘å¸ƒæ—¥æœŸ**: 2026-02-23
- **npm åŒ…**: `@eyeclaw/eyeclaw@2.0.4`
- **åŒ…å¤§å°**: 10.8 kB (å‹ç¼©å)
- **shasum**: f82d02362a358a7a20e0e91fca29e605fad9ab17

## é‡è¦æ›´æ–°

### ğŸ‰ æ–°å¢æµå¼è¾“å‡ºåŠŸèƒ½

æ­¤ç‰ˆæœ¬è§£å†³äº†ä¹‹å‰ç”¨æˆ·å¿…é¡»é•¿æ—¶é—´ç­‰å¾…å®Œæ•´å“åº”çš„é—®é¢˜ï¼Œç°åœ¨ Bot å›å¤å°†å®æ—¶é€å­—ç¬¦æ˜¾ç¤ºï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

### æ ¸å¿ƒæ”¹è¿›

#### 1. SDK åç«¯æµå¼å¤„ç† (`src/channel.ts`)
- **æ›¿æ¢ `exec` ä¸º `spawn`**: ä»é˜»å¡å¼å‘½ä»¤æ‰§è¡Œåˆ‡æ¢åˆ°å®æ—¶æµå¼å¤„ç†
- **æµç”Ÿå‘½å‘¨æœŸç®¡ç†**: æ·»åŠ  `stream_start`ã€`stream_chunk`ã€`stream_end`ã€`stream_error` äº‹ä»¶
- **æ™ºèƒ½ç¼“å†²åŒºç®¡ç†**: å¤„ç†ä¸å®Œæ•´çš„ JSON/æ–‡æœ¬è¡Œï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§
- **åˆ†å—ä¼ è¾“**: å°†å¤§å“åº”åˆ†å‰²æˆ 50 å­—ç¬¦çš„å—è¿›è¡Œä¼ è¾“

#### 2. SDK å®¢æˆ·ç«¯æ”¯æŒ (`src/client.ts`)
- **æ–°å¢ `sendStreamChunk()` æ–¹æ³•**: å‘é€æµå¼æ•°æ®å—åˆ° WebSocket æœåŠ¡å™¨
- **ç±»å‹å®‰å…¨æ”¹è¿›**: ä¿®å¤ TypeScript ç±»å‹æ£€æŸ¥é—®é¢˜ï¼ˆmessage.chunk ç±»å‹å¤„ç†ï¼‰
- **è°ƒè¯•æ—¥å¿—å¢å¼º**: æ·»åŠ æµå¼æ•°æ®å—é¢„è§ˆæ—¥å¿—

#### 3. å‰ç«¯ UI æ›´æ–° (`app/javascript/controllers/chat_controller.ts`)
- **æµå¼æ¶ˆæ¯ç®¡ç†**: ä½¿ç”¨ Map æ•°æ®ç»“æ„ç®¡ç†å¤šä¸ªå¹¶å‘æµ
- **å®æ—¶å†…å®¹è¿½åŠ **: `appendStreamingChunk()` æ–¹æ³•é€æ­¥æ›´æ–°æ¶ˆæ¯å†…å®¹
- **è§†è§‰åé¦ˆ**: æ·»åŠ  CSS pulse åŠ¨ç”»æŒ‡ç¤ºå™¨æ˜¾ç¤ºæ­£åœ¨æ¥æ”¶æ•°æ®
- **è‡ªåŠ¨æ»šåŠ¨**: æ–°å†…å®¹åˆ°è¾¾æ—¶è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨

## å®‰è£…æ–¹æ³•

### æ–¹å¼ä¸€ï¼šå®‰è£…æœ€æ–°ç‰ˆæœ¬
```bash
npm install @eyeclaw/eyeclaw@latest
```

### æ–¹å¼äºŒï¼šæŒ‡å®šç‰ˆæœ¬å®‰è£…
```bash
npm install @eyeclaw/eyeclaw@2.0.4
```

### æ–¹å¼ä¸‰ï¼šå…¨å±€å®‰è£…
```bash
npm install -g @eyeclaw/eyeclaw@2.0.4
```

## ä½¿ç”¨ç¤ºä¾‹

### OpenClaw Gateway é…ç½®

```bash
# å¯åŠ¨ OpenClaw Gatewayï¼ˆè‡ªåŠ¨åŠ è½½ eyeclaw æ’ä»¶ï¼‰
openclaw gateway start
```

### æµ‹è¯•æµå¼è¾“å‡º

1. å¯åŠ¨ OpenClaw Gateway
2. åœ¨ EyeClaw Web ç•Œé¢æ‰“å¼€èŠå¤©
3. å‘é€æ¶ˆæ¯ï¼Œè§‚å¯Ÿ Bot å›å¤å®æ—¶é€å­—ç¬¦æ˜¾ç¤º

## æŠ€æœ¯ç»†èŠ‚

### æµå¼æ•°æ®æ ¼å¼

```typescript
// stream_start - å¼€å§‹æµå¼ä¼ è¾“
{
  type: 'stream_start',
  stream_id: '1708705200000',
  chunk: '',
  timestamp: '2026-02-23T12:00:00Z'
}

// stream_chunk - æ•°æ®å—
{
  type: 'stream_chunk',
  stream_id: '1708705200000',
  chunk: 'Hello, this is a streaming message...',
  timestamp: '2026-02-23T12:00:01Z'
}

// stream_end - ç»“æŸæµå¼ä¼ è¾“
{
  type: 'stream_end',
  stream_id: '1708705200000',
  chunk: '',
  timestamp: '2026-02-23T12:00:05Z'
}

// stream_error - é”™è¯¯å¤„ç†
{
  type: 'stream_error',
  stream_id: '1708705200000',
  chunk: 'Error message here',
  timestamp: '2026-02-23T12:00:05Z'
}
```

### æ¶æ„è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     spawn + stdout.on('data')     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenClaw Agent â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  SDK Channel â”‚
â”‚   (openclaw)    â”‚                                     â”‚  (channel.ts)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â”‚ WebSocket
                                                               â”‚ stream_chunk
                                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ActionCable Broadcast          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Rails Server  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  SDK Client  â”‚
â”‚  (BotChannel)   â”‚                                     â”‚  (client.ts) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ WebSocket
         â”‚ stream_chunk
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     handleStreamChunk()            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web Browser   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   Stimulus   â”‚
â”‚  (User's UI)    â”‚     Real-time DOM Update           â”‚   Controller â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é—®é¢˜ä¿®å¤

### åŒ…å®Œæ•´æ€§é—®é¢˜è§£å†³

åœ¨å‘å¸ƒè¿‡ç¨‹ä¸­é‡åˆ° npm åŒ…å®Œæ•´æ€§æ¼‚ç§»é—®é¢˜ (`npm package integrity drift`)ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹æ³•è§£å†³ï¼š

1. **æ’¤é”€æœ‰é—®é¢˜çš„ç‰ˆæœ¬**: `npm unpublish @eyeclaw/eyeclaw@2.0.3 --force`
2. **å¢åŠ ç‰ˆæœ¬å·**: ä» 2.0.3 å‡çº§åˆ° 2.0.4
3. **é‡æ–°å‘å¸ƒ**: ç¡®ä¿åŒ…å®Œæ•´æ€§æ­£ç¡®

### TypeScript ç±»å‹æ£€æŸ¥ä¿®å¤

- **é—®é¢˜**: `Property 'substring' does not exist on type '{}'`
- **æ–‡ä»¶**: `src/client.ts:124`
- **ä¿®å¤**: æ·»åŠ ç±»å‹æ£€æŸ¥ `typeof message.chunk === 'string'`

## å‘åå…¼å®¹æ€§

æ­¤ç‰ˆæœ¬å®Œå…¨å‘åå…¼å®¹ï¼Œç°æœ‰åŠŸèƒ½ä¸å—å½±å“ã€‚å¦‚æœä¸ä½¿ç”¨æµå¼è¾“å‡ºåŠŸèƒ½ï¼ŒSDK å°†ç»§ç»­æ­£å¸¸å·¥ä½œã€‚

## ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ·»åŠ æµå¼è¾“å‡ºé€Ÿç‡æ§åˆ¶
- [ ] æ”¯æŒ Markdown å®æ—¶æ¸²æŸ“
- [ ] æ·»åŠ æµå¼è¾“å‡ºä¸­æ–­åŠŸèƒ½
- [ ] ä¼˜åŒ–å¤§æ–‡ä»¶/é•¿å“åº”çš„å†…å­˜ä½¿ç”¨

## å‚è€ƒæ–‡æ¡£

- [æµå¼è¾“å‡ºæµ‹è¯•æŒ‡å—](./STREAMING_TEST.md)
- [SDK README](./README.md)
- [OpenClaw æ–‡æ¡£](https://github.com/openclaw/openclaw)

## åé¦ˆä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- GitHub Issues: https://github.com/eyeclaw/eyeclaw/issues
- Email: support@eyeclaw.ai
